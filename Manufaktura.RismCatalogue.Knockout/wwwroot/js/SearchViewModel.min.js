var SearchViewModel=function(){var n=this;this.pageSize=100;this.results=ko.observableArray([]);this.player=new PlaybackManager;this.isLoading=ko.observable(!1);this.mayHaveMoreResults=!0;this.currentQuery={intervals:[],skip:0,take:n.pageSize};this.startNewSearch=function(t){n.isLoading()||(n.mayHaveMoreResults=!0,n.currentQuery=t,n.results([]),n.getMoreResults())};this.getMoreResults=function(){!n.isLoading()&&n.mayHaveMoreResults&&(n.isLoading(!0),$.ajax({type:"POST",url:"api/Search/Search",contentType:"application/json",dataType:"json",data:JSON.stringify(n.currentQuery)}).done(function(t){var i,r;n.isLoading(!1);n.mayHaveMoreResults=t.results.length==n.pageSize;for(i in t.results)r=t.results[i],n.results.push(r);n.currentQuery.skip=n.results().length;console.info("Query finished in "+t.queryTime+" ms.")}))};this.getRismLink=function(n){return"https://opac.rism.info/search?id="+n+"&View=rism"};this.formatRelevance=function(n){return n<0?"0 %":parseFloat(n).toFixed(0)+" %"}};